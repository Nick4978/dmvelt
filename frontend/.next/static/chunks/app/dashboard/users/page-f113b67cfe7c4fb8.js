(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[618],{3092:function(e,t,s){Promise.resolve().then(s.bind(s,8880))},2788:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthProvider:function(){return l},useAuth:function(){return o}});var r=s(3827),n=s(4090),a=s(7907);let c=(0,n.createContext)({user:null,loading:!0,logout:()=>{}});function l(e){let{children:t}=e,[s,l]=(0,n.useState)(null),[o,i]=(0,n.useState)(!0),u=(0,a.useRouter)();(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("http://localhost:4000","/auth/check"),{method:"GET",credentials:"include"});if(!e.ok)throw Error("Not logged in");console.log("Not Logged In!");let t=await e.json();l({id:t.userId,name:t.name,role:t.role})}catch(e){l(null)}finally{i(!1)}})()},[]);let d=async()=>{await fetch("".concat("http://localhost:4000","/auth/logout"),{method:"POST",credentials:"include"}),l(null),u.push("/login")};return(0,r.jsx)(c.Provider,{value:{user:s,loading:o,logout:d},children:t})}function o(){return(0,n.useContext)(c)}},8880:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var r=s(3827),n=s(4090),a=s(2788),c=s(8792),l=s(7907);function o(){let[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(1),[o,i]=(0,n.useState)(25),[u,d]=(0,n.useState)(0),[h,p]=(0,n.useState)(!0),[m,x]=(0,n.useState)([]),[f,g]=(0,n.useState)(""),[j,b]=(0,n.useState)(""),[y,N]=(0,n.useState)(""),[C,S]=(0,n.useState)(null),[v,k]=(0,n.useState)(!0),w=(0,n.useRef)(null);(0,n.useEffect)(()=>{(async()=>{p(!0);try{let e=new URLSearchParams({page:String(s),limit:String(o),search:j}),r=await fetch("".concat("http://localhost:4000","/users/get?").concat(e.toString()),{method:"GET",credentials:"include"});if(!r.ok)throw Error("Failed to fetch users");let n=await r.json();t(n.users),d(n.totalPages)}catch(e){console.error("Error fetching users:",e)}finally{p(!1)}})()},[s,o,j]),(0,n.useEffect)(()=>{let e=setTimeout(()=>{b(y),a(1)},300);return()=>clearTimeout(e)},[y]);let E=e=>{x(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},P=m.length>0&&m.length===e.length;m.length,(0,n.useEffect)(()=>{w.current&&(w.current.indeterminate=m.length>0&&!P)},[m,P]);let z=(0,l.useRouter)(),T=[...e].sort((e,t)=>{if(!C)return 0;let s=(e,t)=>{switch(t){case"user.name":return e.name;case"user.address":return e.address;case"user.city":return e.city;case"user.state":return e.state;case"user.zipCode":return e.zipCode;default:return e[t]}},r=s(e,C),n=s(t,C);return"number"==typeof r&&"number"==typeof n?v?r-n:n-r:v?String(r).localeCompare(String(n)):String(n).localeCompare(String(r))}),_=(0,l.usePathname)();return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mt-6",children:[(0,r.jsxs)("div",{className:"flex justify-end mb-4",children:[(0,r.jsx)("label",{className:"text-sm mr-2 self-center",children:"Items per page"}),(0,r.jsxs)("select",{value:o,onChange:e=>{i(Number(e.target.value)),a(1)},className:"border rounded px-2 py-1 text-sm border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:25,children:"25"}),(0,r.jsx)("option",{value:50,children:"50"}),(0,r.jsx)("option",{value:100,children:"100"})]})]}),(0,r.jsxs)("table",{className:"min-w-full text-sm text-left",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-100 text-xs uppercase text-gray-600",children:[(0,r.jsx)("th",{className:"p-2",children:(0,r.jsx)("input",{ref:w,type:"checkbox",checked:P,onChange:()=>{P?x([]):x(e.map(e=>e.id))},onClick:e=>e.stopPropagation()})}),(0,r.jsxs)("th",{onClick:()=>{"user.name"===C?k(!v):(S("user.name"),k(!0))},className:"p-2 cursor-pointer select-none",children:["Name ","user.name"===C&&(v?"▲":"▼"),(0,r.jsx)("input",{type:"text",placeholder:"[...]",value:y,onChange:e=>{e.stopPropagation(),N(e.target.value)},onClick:e=>e.stopPropagation(),className:"bg-gray-100 rounded px-2 py-1 text-sm border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("th",{onClick:()=>{"user.address"===C?k(!v):(S("user.address"),k(!0))},className:"p-2 cursor-pointer select-none text-center",children:["Address ","user.address"===C&&(v?"▲":"▼")]}),(0,r.jsxs)("th",{onClick:()=>{"user.city"===C?k(!v):(S("user.city"),k(!0))},className:"p-2 cursor-pointer select-none",children:["City ","user.city"===C&&(v?"▲":"▼")]}),(0,r.jsxs)("th",{onClick:()=>{"user.state"===C?k(!v):(S("user.state"),k(!0))},className:"p-2 cursor-pointer select-none",children:["State ","user.state"===C&&(v?"▲":"▼")]}),(0,r.jsxs)("th",{onClick:()=>{"user.zipCode"===C?k(!v):(S("user.zipCode"),k(!0))},className:"p-2 cursor-pointer select-none",children:["Zip Code ","user.zipCode"===C&&(v?"▲":"▼")]})]})}),(0,r.jsx)("tbody",{children:T.map(e=>(0,r.jsxs)("tr",{onClick:()=>z.push("".concat(_,"/user/").concat(e.id)),className:"border-b hover:bg-blue-100 transition-colors",children:[(0,r.jsx)("td",{className:"p-2",children:(0,r.jsx)("input",{type:"checkbox",checked:m.includes(e.id),onChange:()=>E(e.id),onClick:e=>e.stopPropagation()})}),(0,r.jsx)("td",{className:"p-2",children:(0,r.jsx)(c.default,{href:"".concat(_,"/users/").concat(e.id),className:"text-blue-600 hover:underline",children:e.name})}),(0,r.jsx)("td",{className:"p-2",children:e.address}),(0,r.jsx)("td",{className:"p-2",children:e.city}),(0,r.jsx)("td",{className:"p-2 text-center",children:e.state}),(0,r.jsx)("td",{className:"p-2",children:e.zipCode})]},e.id))})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Page ",s," of ",u]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>a(e=>Math.max(e-1,1)),disabled:1===s,className:"px-3 py-1 bg-gray-200 rounded text-sm disabled:opacity-50",children:"Previous"}),(0,r.jsx)("button",{onClick:()=>a(e=>Math.min(e+1,u)),disabled:s===u,className:"px-3 py-1 bg-gray-200 rounded text-sm disabled:opacity-50",children:"Next"})]})]})]})}function i(){let{user:e}=(0,a.useAuth)(),[t,s]=(0,n.useState)([]),[c,l]=(0,n.useState)(!0);return((0,n.useEffect)(()=>{fetch("".concat("http://localhost:4000","/users/getall"),{method:"GET",credentials:"include"}).then(e=>e.json()).then(e=>{s(e.users),l(!1)})},[]),c)?(0,r.jsx)("div",{children:"Loading users..."}):(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Users"}),(0,r.jsx)(o,{})]})}}},function(e){e.O(0,[901,971,69,744],function(){return e(e.s=3092)}),_N_E=e.O()}]);