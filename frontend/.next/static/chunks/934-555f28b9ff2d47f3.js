"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[934],{7934:function(e,t,s){s.d(t,{Z:function(){return h}});var l=s(3827),n=s(4090),a=s(8792),i=s(7907),r=s(3125),c=s(5149),o=s(9475),d=s(9990),u=s(4187);function h(e){let{readFlag:t}=e,[s,h]=(0,n.useState)([]),[x,m]=(0,n.useState)(1),[p,g]=(0,n.useState)(25),[b,j]=(0,n.useState)(0),[v,f]=(0,n.useState)(!0),[y,N]=(0,n.useState)([]),[k,S]=(0,n.useState)(null),[C,w]=(0,n.useState)(""),[D,P]=(0,n.useState)(null),[E,R]=(0,n.useState)(""),[A,L]=(0,n.useState)(""),M={0:{label:"Lien Received",color:"bg-gray-200 text-gray-800",icon:"\uD83D\uDCE5",tooltip:"The lien has been received but not processed.",jsx:(0,l.jsx)(c.Z,{size:12})},1:{label:"Satisfy Submitted",color:"bg-yellow-200 text-yellow-800",icon:"\uD83D\uDCDD",tooltip:"Satisfy paperwork submitted but not sent yet.",jsx:(0,l.jsx)(o.Z,{size:12})},2:{label:"Satisfy Sent",color:"bg-blue-200 text-blue-800",icon:"\uD83D\uDCE4",tooltip:"Satisfy documents sent to lienholder.",jsx:(0,l.jsx)(d.Z,{size:12})},3:{label:"Satisfy Confirmed",color:"bg-green-200 text-green-800",icon:"✅",tooltip:"Lien has been satisfied and confirmed.",jsx:(0,l.jsx)(u.Z,{size:12})}},[F,Z]=(0,n.useState)(null),[z,T]=(0,n.useState)(!0),U=(0,n.useRef)(null);(0,n.useEffect)(()=>{(async()=>{f(!0);try{let e=new URLSearchParams({page:String(x),limit:String(p),search:E});null!==D&&e.append("status",D.toString());let s=await fetch("".concat("http://localhost:4000","/liens/getall?readFlag=").concat(null!=t&&t,"&").concat(e.toString()),{method:"GET",credentials:"include"});if(!s.ok)throw Error("Failed to fetch liens");let l=await s.json();h(l.liens),j(l.totalPages)}catch(e){console.error("Error fetching liens:",e)}finally{f(!1)}})()},[t,x,p,D,E]),(0,n.useEffect)(()=>{let e=setTimeout(()=>{R(A),m(1)},300);return()=>clearTimeout(e)},[A]);let _=e=>{N(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},q=y.length>0&&y.length===s.length,I=y.length>1;(0,n.useEffect)(()=>{U.current&&(U.current.indeterminate=y.length>0&&!q)},[y,q]);let V=(0,i.useRouter)(),G=[...s].sort((e,t)=>{if(!F)return 0;let s=(e,t)=>{switch(t){case"vehicle.vin":return e.vehicle.vin;case"vehicle.make":return e.vehicle.make;case"vehicle.model":return e.vehicle.model;case"vehicle.year":return e.vehicle.year;default:return e[t]}},l=s(e,F),n=s(t,F);return"number"==typeof l&&"number"==typeof n?z?l-n:n-l:z?String(l).localeCompare(String(n)):String(n).localeCompare(String(l))}),O=(0,i.usePathname)();return(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mt-6",children:[(0,l.jsx)("h2",{className:"text-lg font-bold mb-4",children:t?"Viewed Liens":"New Liens"}),null!==D&&(0,l.jsx)("div",{className:"flex justify-start mb-1",children:(0,l.jsx)("button",{onClick:()=>P(null),className:"text-sm text-blue-600 hover:underline",children:"Clear status filter"})}),(0,l.jsxs)("div",{className:"flex justify-end mb-4",children:[(0,l.jsx)("label",{className:"text-sm mr-2 self-center",children:"Items per page"}),(0,l.jsxs)("select",{value:p,onChange:e=>{g(Number(e.target.value)),m(1)},className:"border rounded px-2 py-1 text-sm border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:25,children:"25"}),(0,l.jsx)("option",{value:50,children:"50"}),(0,l.jsx)("option",{value:100,children:"100"})]})]}),(0,l.jsxs)("table",{className:"min-w-full text-sm text-left",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-100 text-xs uppercase text-gray-600",children:[(0,l.jsx)("th",{className:"p-2",children:(0,l.jsx)("input",{ref:U,type:"checkbox",checked:q,onChange:()=>{q?N([]):N(s.map(e=>e.id))},onClick:e=>e.stopPropagation()})}),(0,l.jsxs)("th",{onClick:()=>{"lien.createdAt"===F?T(!z):(Z("lien.createdAt"),T(!0))},className:"p-2 cursor-pointer select-none",children:["Created At"," ","lien.createdAt"===F&&(z?"▲":"▼")]}),(0,l.jsxs)("th",{onClick:()=>{"lien.rank"===F?T(!z):(Z("lien.rank"),T(!0))},className:"p-2 cursor-pointer select-none text-center",children:["Lien Rank ","lien.rank"===F&&(z?"▲":"▼")]}),(0,l.jsx)("th",{onClick:()=>{"vehicle.vin"===F?T(!z):(Z("vehicle.vin"),T(!0))},className:"p-2 cursor-pointer select-none",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("span",{children:["VIN ","vehicle.vin"===F&&(z?"▲":"▼")]}),(0,l.jsx)("input",{type:"text",placeholder:"[...]",value:A,onChange:e=>{e.stopPropagation(),L(e.target.value)},onClick:e=>e.stopPropagation(),className:"bg-gray-100 rounded px-2 py-0.5 text-sm border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),(0,l.jsxs)("th",{onClick:()=>{"vehicle.year"===F?T(!z):(Z("vehicle.year"),T(!0))},className:"p-2 cursor-pointer select-none",children:["Year ","vehicle.year"===F&&(z?"▲":"▼")]}),(0,l.jsxs)("th",{onClick:()=>{"vehicle.make"===F?T(!z):(Z("vehicle.make"),T(!0))},className:"p-2 cursor-pointer select-none",children:["Make ","vehicle.make"===F&&(z?"▲":"▼")]}),(0,l.jsxs)("th",{onClick:()=>{"vehicle.model"===F?T(!z):(Z("vehicle.model"),T(!0))},className:"p-2 cursor-pointer select-none",children:["Model ","vehicle.model"===F&&(z?"▲":"▼")]}),(0,l.jsxs)("th",{onClick:()=>{"lien.status"===F?T(!z):(Z("lien.status"),T(!0))},className:"p-2 cursor-pointer select-none",children:["Status ","lien.status"===F&&(z?"▲":"▼")]}),(0,l.jsx)("th",{className:"p-2",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:G.map(e=>{var t,s,n,i;return(0,l.jsxs)("tr",{onClick:()=>V.push("".concat(O,"/liens/").concat(e.id)),className:"border-b hover:bg-blue-100 transition-colors",children:[(0,l.jsx)("td",{className:"p-2",children:(0,l.jsx)("input",{type:"checkbox",checked:y.includes(e.id),onChange:()=>_(e.id),onClick:e=>e.stopPropagation()})}),(0,l.jsx)("td",{className:"p-2",children:(0,r.WU)(new Date(e.createdAt),"M/d/yyyy p")}),(0,l.jsx)("td",{className:"p-2 text-center",children:e.rank.toString()}),(0,l.jsx)("td",{className:"p-2",children:(0,l.jsx)(a.default,{href:"".concat(O,"/liens/").concat(e.id),className:"text-blue-600 hover:underline",children:e.vehicle.vin})}),(0,l.jsx)("td",{className:"p-2 text-center",children:e.vehicle.year}),(0,l.jsx)("td",{className:"p-2",children:e.vehicle.make}),(0,l.jsx)("td",{className:"p-2",children:e.vehicle.model}),(0,l.jsx)("td",{className:"p-2",children:(0,l.jsxs)("button",{className:"px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1 cursor-pointer hover:opacity-90 transition ".concat((null===(t=M[e.status])||void 0===t?void 0:t.color)||"bg-red-200 text-red-800"),title:(null===(s=M[e.status])||void 0===s?void 0:s.tooltip)||"Unknown status",onClick:t=>{t.stopPropagation(),P(t=>t===e.status?null:e.status),console.log("Filter by status:",e.status)},children:[(0,l.jsx)("span",{children:null===(n=M[e.status])||void 0===n?void 0:n.jsx}),(0,l.jsx)("span",{children:null===(i=M[e.status])||void 0===i?void 0:i.label})]})}),(0,l.jsx)("td",{className:"p-2",children:!I&&(0,l.jsxs)("div",{className:"space-x-2",children:[(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),S(e.id)},className:"text-blue-600 hover:underline text-xs",children:"Request"}),(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),S(e.id)},className:"text-green-600 hover:underline text-xs",children:"Satisfy"}),(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),S(e.id)},className:"text-red-600 hover:underline text-xs",children:"Report"})]})})]},e.id)})})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["Page ",x," of ",b]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>m(e=>Math.max(e-1,1)),disabled:1===x,className:"px-3 py-1 bg-gray-200 rounded text-sm disabled:opacity-50",children:"Previous"}),(0,l.jsx)("button",{onClick:()=>m(e=>Math.min(e+1,b)),disabled:x===b,className:"px-3 py-1 bg-gray-200 rounded text-sm disabled:opacity-50",children:"Next"})]})]}),I&&(0,l.jsxs)("div",{className:"flex justify-end gap-3 mt-4",children:[(0,l.jsx)("button",{className:"bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700",children:"Satisfy Selected"}),(0,l.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700",children:"Request Selected"})]}),null!==k&&(0,l.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded border",children:[(0,l.jsx)("h3",{className:"text-sm font-semibold mb-2",children:"Enter Mailing Address"}),(0,l.jsx)("textarea",{className:"w-full text-sm p-2 border rounded",rows:3,value:C,onChange:e=>w(e.target.value),placeholder:"123 Main St, Orlando, FL 32801"}),(0,l.jsxs)("div",{className:"flex items-center mt-2",children:[(0,l.jsx)("input",{id:"useDealer",type:"checkbox",className:"mr-2"}),(0,l.jsx)("label",{htmlFor:"useDealer",className:"text-sm text-gray-600",children:"Use dealer mailing address"})]}),(0,l.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,l.jsx)("button",{className:"bg-blue-600 text-white text-sm px-3 py-1 rounded hover:bg-blue-700",children:"Submit"}),(0,l.jsx)("button",{onClick:()=>S(null),className:"text-sm text-gray-500 hover:text-black",children:"Cancel"})]})]})]})}}}]);